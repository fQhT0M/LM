Описание данных
В данном проекте используются три набора данных:

1. Файл ferma_main.csv
Содержит информацию о текущем стаде фермера.

Столбцы:

id — уникальный идентификатор коровы.
udoi_kg — количество молока, которое корова даёт в год (в килограммах).
eke — энергетическая кормовая единица (показатель питательности корма).
syroy_protein_g — содержание сырого протеина в корме (в граммах).
spo — сахаро-протеиновое соотношение в корме.
poroda — порода коровы.
tip_pastbischa — тип лугов, на которых паслась корова.
poroda_papy_byka — порода отца коровы.
zhirnost_procent — содержание жиров в молоке (в процентах).
belok_procent — содержание белков в молоке (в процентах).
vkus_moloka — субъективная оценка вкуса молока фермером (vkusno / ne_vkusno).
vozrast — возраст коровы (menee_2_let / bolee_2_let).
Признаки можно разделить на несколько категорий:

Характеристики коровы: id, poroda, poroda_papy_byka, vozrast.
Характеристики корма: eke, syroy_protein_g, spo.
Характеристика пастбища: tip_pastbischa.
Характеристики молока: udoi_kg, zhirnost_procent, belok_procent, vkus_moloka.
Такое разделение помогает понять взаимосвязи между параметрами.

2. Файл ferma_dad.csv
Содержит информацию о родословной коров.

Столбцы:

id — уникальный идентификатор коровы.
imya_papy — имя отца коровы.
3. Файл cow_buy.csv
Содержит данные о коровах «ЭкоФермы», которых фермер рассматривает для покупки.

Столбцы:

poroda — порода коровы.
tip_pastbischa — тип лугов, на которых паслась корова.
poroda_papy_byka — порода отца коровы.
imya_papy — имя отца коровы.
tekuschaya_zhirnost_procent — содержание жиров в молоке (в процентах) на момент продажи.
tekuschiy_uroven_belok_procent — содержание белков в молоке (в процентах) на момент продажи.
vozrast — возраст коровы (menee_2_let / bolee_2_let).
Особенности данных cow_buy.csv
tekuschaya_zhirnost_procent и tekuschiy_uroven_belok_procent зафиксированы в момент продажи, когда коровы питались кормом «ЭкоФермы».
Параметры корма (eke, syroy_protein_g, spo) отсутствуют, так как планируется увеличить их значения на 5% после покупки.
Отсутствуют признаки udoi_kg и vkus_moloka, поскольку именно их предстоит предсказать.


Алгоритм выполнения проекта:  


Данные были загружены из файлов /datasets/ferma_main.csv, /datasets/ferma_dad.csv и /datasets/cow_buy.csv. Проведено изучение их структуры, соответствие описанию задачи, а также проверка на корректность типов данных. При необходимости были переименованы столбцы для единообразия и удобства работы.

Выполнена предобработка данных:

Проведена проверка на наличие пропусков и дубликатов, выявленные проблемы устранены.
Проанализированы типы данных, и при необходимости выполнено их преобразование.
Обработаны специфические значения, которые могли повлиять на анализ, в том числе приведены в корректный вид бинарные и категориальные признаки.
Проведён исследовательский анализ данных:

Рассчитаны основные статистические характеристики признаков.
Построены визуализации для количественных и категориальных переменных, включая гистограммы, диаграммы рассеяния и боксплоты.
Выявлены выбросы, необычные распределения и другие особенности данных. Определены стратегии их обработки для дальнейшего моделирования.
Выполнен корреляционный анализ признаков в датасете ferma_main.csv:

Рассчитаны коэффициенты корреляции между всеми количественными переменными.
Построены диаграммы рассеяния (scatterplot) для показателя udoi_kg и других количественных признаков с учетом категориальных характеристик.
Определены основные зависимости между целевым и входными признаками, включая возможные нелинейные связи и мультиколлинеарность.
Выявлены признаки, требующие преобразования перед использованием в модели линейной регрессии.
Обучены три модели линейной регрессии:

Базовая модель использовала стандартный набор признаков, прошедших предобработку, включая закодированные категориальные и масштабированные количественные переменные. Оценены её качество по метрике R² и анализ остатков.
Улучшенная модель включала обработку нелинейных зависимостей между spo и udoi_kg, а также введение квадратичного признака для eke, что позволило повысить предсказательную способность модели.
Дополненная модель использовала информацию о imya_papy, объединённую из ferma_dad.csv, что позволило учесть влияние наследственности на удой.
Для всех моделей рассчитаны метрики MSE, MAE и RMSE, выполнено их сравнение. Определена лучшая модель, для которой дополнительно рассчитан доверительный интервал прогноза.

Используя лучшую модель, спрогнозирован удой коров из cow_buy.csv. Добавлены недостающие признаки (eke, syroy_protein_g, spo) на основе средних значений из ferma_main.csv, увеличенных на 5%. Проведена аналогичная подготовка данных, после чего получены прогнозные значения удоя для коров, рассматриваемых к покупке.

Обучена модель логистической регрессии для предсказания признака vkus_moloka.

Выполнено кодирование категориальных признаков с помощью OneHotEncoder и масштабирование количественных данных с StandardScaler.
Обучена модель логистической регрессии, рассчитаны метрики accuracy, recall, precision.
Построена матрица ошибок, проведён анализ значимости различных типов ошибок с точки зрения бизнеса.
Определено, что важнее минимизировать ошибки второго рода, так как для заказчика критично предсказывать «вкусное» молоко корректно.
Подобран оптимальный порог классификации, позволяющий снизить риск ошибок.
Спрогнозирован вкус молока для коров из cow_buy.csv.
Итоговые выводы
Добавлены прогнозные значения удоя и вкуса молока в датасет cow_buy.csv.
Отобраны коровы с удоем более 6000 кг и прогнозируемым вкусным молоком.
Определено, сколько коров фермер может купить с минимальным риском и на основании каких критериев.
Сделаны выводы о качестве моделей линейной и логистической регрессии.
Рассмотрены возможные пути улучшения регрессионной модели, в том числе за счёт дополнительных признаков и обработки нелинейных зависимостей.
Оценены метрики классификации и их значимость при принятии бизнес-решений.
Полученные результаты могут быть использованы для оптимизации закупки новых коров, улучшения системы кормления и прогнозирования удоя в будущем.
